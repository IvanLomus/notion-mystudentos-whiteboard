<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notion Sketchpad</title>
    <style>
        /* –°—Ç–∏–ª—å –ø–æ–¥ Notion */
        body {
            margin: 0;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            background-color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
        }

        /* –ü–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ */
        .toolbar {
            display: flex;
            gap: 8px;
            padding: 8px;
            background: #f7f7f5; /* –õ–µ–≥–∫–∏–π —Å–µ—Ä—ã–π —Ñ–æ–Ω –ø–∞–Ω–µ–ª–∏ */
            border-bottom: 1px solid #e0e0e0;
            width: 100%;
            justify-content: center;
            box-sizing: border-box;
        }

        button {
            border: 1px solid transparent;
            background: transparent;
            padding: 6px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            color: #37352f;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        button:hover { background: rgba(55, 53, 47, 0.08); }
        button.active { background: rgba(55, 53, 47, 0.16); }

        /* –ö–Ω–æ–ø–∫–∞ SAVE - –°–∏–Ω—è—è */
        button.save-btn {
            background: #2383e2;
            color: white;
            font-weight: 500;
            margin-left: 10px;
        }
        button.save-btn:hover { background: #1a6fc0; }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã */
        #canvasContainer {
            flex-grow: 1;
            width: 100%;
            position: relative;
            cursor: crosshair;
        }

        #resultContainer {
            display: none; /* –°–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
            flex-grow: 1;
            width: 100%;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #fcfcfc;
        }

        canvas { display: block; }

        /* –§–∏–Ω–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ */
        #finalImage {
            max-width: 90%;
            max-height: 80%;
            border: 1px dashed #ccc;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            cursor: grab;
        }

        .instruction {
            margin-bottom: 15px;
            color: #787774;
            font-size: 14px;
            font-weight: 500;
        }
    </style>
</head>
<body>

<div class="toolbar" id="mainToolbar">
    <button id="brushBtn" class="active" onclick="setMode('brush')">‚úèÔ∏è Draw</button>
    <button id="eraserBtn" onclick="setMode('eraser')">üßº Erase</button>
    <button onclick="clearCanvas()">üóë Clear</button>
    <button class="save-btn" onclick="saveImage()">üíæ Save</button>
</div>

<div id="canvasContainer">
    <canvas id="drawingCanvas"></canvas>
</div>

<div id="resultContainer">
    <div class="instruction">‚ú® Ready! Drag this image into Notion:</div>
    <img id="finalImage" />
    <button onclick="editAgain()" style="margin-top: 15px; text-decoration: underline;">‚Üê Edit again</button>
</div>

<script>
    const canvas = document.getElementById('drawingCanvas');
    const ctx = canvas.getContext('2d');
    const canvasContainer = document.getElementById('canvasContainer');
    const resultContainer = document.getElementById('resultContainer');
    const finalImage = document.getElementById('finalImage');
    
    let isDrawing = false;
    let mode = 'brush';

    // 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ (–Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω)
    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight - 50; // –º–∏–Ω—É—Å –≤—ã—Å–æ—Ç–∞ —Ç—É–ª–±–∞—Ä–∞
        
        // –ó–∞–ª–∏–≤–∞–µ–º –±–µ–ª—ã–º (–∏–Ω–∞—á–µ —Ñ–æ–Ω –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π –∏ –ø—Ä–∏ –¥—Ä–∞–≥-–Ω-–¥—Ä–æ–ø –±—É–¥–µ—Ç —á–µ—Ä–Ω–æ—Ç–∞)
        ctx.fillStyle = "white";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
    }
    window.addEventListener('resize', resize);
    resize();

    // 2. –†–∏—Å–æ–≤–∞–Ω–∏–µ
    function startPosition(e) { isDrawing = true; draw(e); }
    function endPosition() { isDrawing = false; ctx.beginPath(); }
    
    function draw(e) {
        if (!isDrawing) return;
        ctx.lineWidth = mode === 'brush' ? 3 : 25;
        ctx.lineCap = 'round';
        ctx.strokeStyle = mode === 'brush' ? '#37352f' : 'white';

        const x = (e.clientX || e.touches[0].clientX);
        const y = (e.clientY || e.touches[0].clientY) - 50; // –ø–æ–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Ç—É–ª–±–∞—Ä

        ctx.lineTo(x, y);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(x, y);
    }

    // –°–ª—É—à–∞—Ç–µ–ª–∏ —Å–æ–±—ã—Ç–∏–π
    canvas.addEventListener('mousedown', startPosition);
    canvas.addEventListener('mouseup', endPosition);
    canvas.addEventListener('mousemove', draw);
    
    // –¢–∞—á—Å–∫—Ä–∏–Ω (iPad)
    canvas.addEventListener('touchstart', startPosition);
    canvas.addEventListener('touchend', endPosition);
    canvas.addEventListener('touchmove', (e) => { e.preventDefault(); draw(e); });

    // –ö–Ω–æ–ø–∫–∏
    function setMode(newMode) {
        mode = newMode;
        document.getElementById('brushBtn').classList.toggle('active', mode === 'brush');
        document.getElementById('eraserBtn').classList.toggle('active', mode === 'eraser');
    }

    function clearCanvas() {
        if(confirm('Clear canvas?')) {
            ctx.fillStyle = "white";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }
    }

    // --- –ì–õ–ê–í–ù–ê–Ø –§–ò–®–ö–ê: –õ–û–ì–ò–ö–ê –°–û–•–†–ê–ù–ï–ù–ò–Ø ---
    function saveImage() {
        // 1. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º —Ö–æ–ª—Å—Ç –≤ –∫–∞—Ä—Ç–∏–Ω–∫—É
        const dataURL = canvas.toDataURL("image/png");
        
        // 2. –í—Å—Ç–∞–≤–ª—è–µ–º –≤ —Ç–µ–≥ IMG
        finalImage.src = dataURL;
        
        // 3. –°–∫—Ä—ã–≤–∞–µ–º —Ä–∏—Å–æ–≤–∞–ª–∫—É, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        document.getElementById('mainToolbar').style.display = 'none';
        canvasContainer.style.display = 'none';
        resultContainer.style.display = 'flex';
    }

    function editAgain() {
        resultContainer.style.display = 'none';
        document.getElementById('mainToolbar').style.display = 'flex';
        canvasContainer.style.display = 'block';
    }
</script>

</body>
</html>
